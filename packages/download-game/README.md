Ported from HMCL

TODO: Rewrite this package.
